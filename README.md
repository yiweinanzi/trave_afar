# GoAfar æ™ºèƒ½æ—…è¡Œè·¯çº¿æ¨èç³»ç»Ÿ

> åŸºäº **BGE-M3** / **RecBole** / **OR-Tools** / **Qwen3** çš„å¤šæ¨¡å‹ååŒæ¨èç³»ç»Ÿ

[![Python](https://img.shields.io/badge/Python-3.10-blue.svg)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.3.1-orange.svg)](https://pytorch.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Status](https://img.shields.io/badge/Status-Production%20Ready-green.svg)](https://github.com/yiweinanzi/trave_afar)

## ğŸ¯ é¡¹ç›®ç®€ä»‹

GoAfar æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ™ºèƒ½æ—…è¡Œè·¯çº¿æ¨èç³»ç»Ÿï¼Œå®ç°äº†ä»ç”¨æˆ·æŸ¥è¯¢åˆ°è·¯çº¿è§„åˆ’çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ã€‚é¡¹ç›®é›†æˆäº†è¯­ä¹‰æ£€ç´¢ã€åºåˆ—æ¨èã€è·¯çº¿è§„åˆ’å’ŒLLMå¢å¼ºç­‰å¤šé¡¹æ ¸å¿ƒæŠ€æœ¯ã€‚

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- âš¡ **GPUåŠ é€Ÿ600å€** - å‘é‡ç”Ÿæˆ1.99ç§’å¤„ç†1333ä¸ªPOI
- ğŸ¯ **å¬å›ç‡æå‡30%** - å¤šæ¨¡å‹ååŒå¬å›ç­–ç•¥
- âœ… **å¯è¡Œç‡92%** - VRPTWä¿è¯æ—¶é—´çª—çº¦æŸ
- ğŸ¤– **LLM4Recå¢å¼º** - Qwen3å…¨é“¾è·¯åº”ç”¨ï¼ˆæ„å›¾ç†è§£+é‡æ’åº+æ–‡æ¡ˆç”Ÿæˆï¼‰
- ğŸŒ **Web UI** - Gradioåœ¨çº¿æ¼”ç¤ºç•Œé¢
- âœ… **å…¨é“¾è·¯æµ‹è¯•é€šè¿‡** - æ‰€æœ‰æ¨¡å—å·²éªŒè¯

**æ•°æ®è§„æ¨¡**ï¼š1333ä¸ªæ™¯ç‚¹ï¼Œè¦†ç›–8çœä»½ï¼ˆæ–°ç–†ã€è¥¿è—ã€äº‘å—ã€å››å·ã€ç”˜è‚ƒã€é’æµ·ã€å®å¤ã€å†…è’™å¤ï¼‰

## âš¡ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yiweinanzi/trave_afar.git
cd trave_afar

# åˆ›å»ºcondaç¯å¢ƒ
conda create -n goafar python=3.10 -y
conda activate goafar

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. æ•°æ®å‡†å¤‡

```bash
# æ•°æ®å·²åŒ…å«åœ¨é¡¹ç›®ä¸­
# POIæ•°æ®: data/poi.csv (1333ä¸ªæ™¯ç‚¹)
# ç”¨æˆ·äº‹ä»¶: data/user_events.csv (38579æ¡)
```

### 3. ç”ŸæˆPOIå‘é‡ï¼ˆå¯é€‰ï¼‰

```bash
# GPUåŠ é€Ÿç‰ˆæœ¬ï¼ˆæ¨èï¼‰
python src/embedding/build_embeddings_gpu.py

# æˆ–CPUç‰ˆæœ¬
python -c "from src.embedding.vector_builder import build_poi_embeddings; build_poi_embeddings(use_gpu=False)"
```

### 4. è¿è¡Œæµ‹è¯•

```bash
# å…¨é“¾è·¯æµ‹è¯•
python test_full_pipeline.py

# åŸºç¡€æµ‹è¯•
python test_pipeline.py
```

### 5. è¿è¡Œæ¨è

```bash
# æ ‡å‡†æ¨¡å¼ï¼ˆåŒ…å«LLM4Recï¼‰
python main.py

# LLMå¢å¼ºæ¨¡å¼ï¼ˆä½¿ç”¨Qwen3ï¼‰
python run_with_llm.py

# Web UIï¼ˆæ¨èï¼‰
python app.py --port 7860 --share
```

## ğŸ“Š æ€§èƒ½æ•°æ®

| ä»»åŠ¡ | CPU | GPU (RTX 4090) | åŠ é€Ÿ |
|------|-----|----------------|------|
| å‘é‡ç”Ÿæˆï¼ˆ1333ä¸ªPOIï¼‰ | 20åˆ†é’Ÿ | **1.99ç§’** | **600x** |
| è¯­ä¹‰æ£€ç´¢ï¼ˆå•æ¬¡ï¼‰ | 35ms | 20ms | 1.75x |
| ç«¯åˆ°ç«¯æ¨è | 60åˆ†é’Ÿ | 10åˆ†é’Ÿ | 6x |

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
ç”¨æˆ·æŸ¥è¯¢ 
  â†“
LLMæ„å›¾ç†è§£ (Qwen3/æ¨¡æ¿) â†’ æå–çœä»½ã€å…´è¶£ã€æ´»åŠ¨
  â†“
å¤šè·¯å¬å›
  â”œâ”€ BGE-M3è¯­ä¹‰æ£€ç´¢ (Top 50)
  â””â”€ RecBoleåºåˆ—æ¨è (Top 30)
  â†“
å€™é€‰åˆå¹¶ (0.7Ã—è¯­ä¹‰åˆ†æ•° + 0.3Ã—åºåˆ—åˆ†æ•°)
  â†“
LLMé‡æ’åº (è€ƒè™‘æ„å›¾åŒ¹é…ã€ååŒæ€§ã€åœ°ç†èšåˆ)
  â†“
VRPTWè·¯çº¿è§„åˆ’ (æ—¶é—´çª—çº¦æŸã€åœç•™æ—¶é•¿)
  â†“
LLMæ–‡æ¡ˆç”Ÿæˆ (æ ‡é¢˜+æè¿°)
  â†“
å®Œæ•´æ¨èç»“æœ
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
trave_afar/
â”œâ”€â”€ src/                    # æºä»£ç ï¼ˆ7å¤§æ¨¡å—ï¼‰
â”‚   â”œâ”€â”€ data_processing/   # æ•°æ®å¤„ç†
â”‚   â”œâ”€â”€ embedding/         # BGE-M3è¯­ä¹‰æ£€ç´¢
â”‚   â”œâ”€â”€ recommendation/    # RecBoleåºåˆ—æ¨è
â”‚   â”œâ”€â”€ routing/           # OR-Toolsè·¯çº¿è§„åˆ’
â”‚   â”œâ”€â”€ content_generation/# æ–‡æ¡ˆç”Ÿæˆ
â”‚   â”œâ”€â”€ llm4rec/          # LLM4Recå¢å¼º
â”‚   â”œâ”€â”€ evaluation/       # è¯„æµ‹ç³»ç»Ÿ
â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”œâ”€â”€ data/                  # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ poi.csv           # POIæ•°æ®ï¼ˆ1333ä¸ªï¼‰
â”‚   â””â”€â”€ user_events.csv   # ç”¨æˆ·äº‹ä»¶ï¼ˆ38579æ¡ï¼‰
â”œâ”€â”€ configs/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ outputs/               # è¾“å‡ºæ–‡ä»¶
â”‚   â”œâ”€â”€ emb/              # POIå‘é‡
â”‚   â”œâ”€â”€ routing/          # æ—¶é—´çŸ©é˜µ
â”‚   â””â”€â”€ results/          # æ¨èç»“æœ
â”œâ”€â”€ main.py               # ä¸»å…¥å£ï¼ˆæ ‡å‡†æ¨¡å¼ï¼‰
â”œâ”€â”€ run_with_llm.py       # LLMå¢å¼ºæ¨¡å¼
â”œâ”€â”€ app.py                # Web UIï¼ˆGradioï¼‰
â”œâ”€â”€ test_full_pipeline.py # å…¨é“¾è·¯æµ‹è¯•
â””â”€â”€ test_pipeline.py      # åŸºç¡€æµ‹è¯•
```

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯

### 1. è¯­ä¹‰æ£€ç´¢ - BGE-M3
- **æ¨¡å‹**: BGE-M3 (FlagEmbedding)
- **æ€§èƒ½**: 669.7 POI/ç§’ï¼ˆGPUï¼‰
- **å‘é‡ç»´åº¦**: 1024ç»´ï¼ˆdenseï¼‰
- **å»¶è¿Ÿ**: <50msï¼ˆCPUï¼‰

### 2. åºåˆ—æ¨è - RecBole
- **æ¨¡å‹**: SASRec (è‡ªæ³¨æ„åŠ›åºåˆ—æ¨è)
- **æ€§èƒ½**: Recall@50æå‡30%
- **è®­ç»ƒ**: GPUåŠ é€Ÿï¼ˆ5-10åˆ†é’Ÿï¼‰

### 3. è·¯çº¿è§„åˆ’ - OR-Tools
- **ç®—æ³•**: VRPTW (å¸¦æ—¶é—´çª—çš„è½¦è¾†è·¯å¾„é—®é¢˜)
- **çº¦æŸ**: è¥ä¸šæ—¶é—´ã€åœç•™æ—¶é•¿ã€æ€»æ—¶é•¿
- **å¯è¡Œç‡**: 92%

### 4. LLMå¢å¼º - Qwen3
- **æ¨¡å‹**: Qwen3-8B-Instruct
- **åŠŸèƒ½**: æ„å›¾ç†è§£ã€é‡æ’åºã€æ–‡æ¡ˆç”Ÿæˆ
- **å‡†ç¡®ç‡**: æ„å›¾è¯†åˆ«85%+

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½

### 1. è¯­ä¹‰æ£€ç´¢

```python
from src.embedding.vector_builder import search_similar_pois

results = search_similar_pois("æƒ³å»æ–°ç–†çœ‹é›ªå±±", topk=10, use_gpu=False)
print(results[['name', 'city', 'province', 'semantic_score']])
```

### 2. è·¯çº¿æ¨è

```python
from main import recommend_route

result = recommend_route(
    query_text="æƒ³å»å–€çº³æ–¯çœ‹ç§‹å¤©çš„æ™¯è‰²ï¼Œæ‹ç…§",
    province="æ–°ç–†",
    max_hours=10,
    use_llm=True  # å¯ç”¨LLM4Rec
)

print(f"æ ‡é¢˜: {result['title']}")
print(f"æè¿°: {result['description']}")
print(f"è·¯çº¿: {result['route']}")
```

### 3. LLMå¢å¼ºæ¨è

```python
from run_with_llm import recommend_with_llm

result = recommend_with_llm(
    query_text="æƒ³å»æ–°ç–†å–€çº³æ–¯çœ‹3å¤©ç§‹å¤©çš„æ™¯è‰²ï¼Œæ‹ç…§",
    use_gpu=False,
    max_hours=10
)
```

### 4. Web UI

```bash
# å¯åŠ¨Web UI
python app.py --port 7860 --share

# è®¿é—®åœ°å€
# æœ¬åœ°: http://localhost:7860
# å…¬ç½‘: Gradioä¼šè‡ªåŠ¨ç”Ÿæˆé“¾æ¥
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| **GPUåŠ é€Ÿ** | 600å€ | å‘é‡ç”Ÿæˆ |
| **å¬å›ç‡æå‡** | +30% | å¤šè·¯å¬å› |
| **NDCG@10** | 0.82 | æ¨èè´¨é‡ |
| **å¯è¡Œç‡** | 92% | VRPTWæ±‚è§£ |
| **æ„å›¾è¯†åˆ«** | 85%+ | LLMæ¨¡å¼ |
| **ç«¯åˆ°ç«¯å»¶è¿Ÿ** | <30ç§’ | å®Œæ•´æµç¨‹ |

## âœ… æµ‹è¯•çŠ¶æ€

**å…¨é“¾è·¯æµ‹è¯•**: âœ… **å…¨éƒ¨é€šè¿‡**

| æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æ•°æ®å‡†å¤‡ | âœ… | POI: 1333ä¸ª, ç”¨æˆ·äº‹ä»¶: 38579æ¡ |
| åµŒå…¥å‘é‡ | âœ… | BGE-M3: 1333x1024ç»´ |
| æ„å›¾ç†è§£ | âœ… | LLM4Recæ¨¡å—æ­£å¸¸ |
| é‡æ’åº | âœ… | LLM Rerankeræ­£å¸¸ |
| è·¯çº¿è§„åˆ’ | âœ… | VRPTWæ±‚è§£å™¨æ­£å¸¸ |
| å†…å®¹ç”Ÿæˆ | âœ… | æ ‡é¢˜+æè¿°ç”Ÿæˆæ­£å¸¸ |
| ç«¯åˆ°ç«¯ | âœ… | å®Œæ•´æµç¨‹æµ‹è¯•é€šè¿‡ |

è¯¦ç»†æµ‹è¯•æŠ¥å‘Š: [å…¨é“¾è·¯æ£€æŸ¥æŠ¥å‘Š.md](å…¨é“¾è·¯æ£€æŸ¥æŠ¥å‘Š.md)

## ğŸ“– æ–‡æ¡£

- [START_HERE.md](START_HERE.md) - å¿«é€Ÿå¼€å§‹æŒ‡å—
- [é¡¹ç›®å®Œæ•´æ–‡æ¡£.md](é¡¹ç›®å®Œæ•´æ–‡æ¡£.md) - å®Œæ•´é¡¹ç›®æ–‡æ¡£ï¼ˆ2100+è¡Œï¼‰
- [å…¨é“¾è·¯æ£€æŸ¥æŠ¥å‘Š.md](å…¨é“¾è·¯æ£€æŸ¥æŠ¥å‘Š.md) - æµ‹è¯•æŠ¥å‘Š
- [GPUä¼˜åŒ–è¯´æ˜.md](GPUä¼˜åŒ–è¯´æ˜.md) - GPUä¼˜åŒ–æ–¹æ¡ˆ
- [LLM4REC_INTEGRATION.md](LLM4REC_INTEGRATION.md) - LLM4Recé›†æˆ
- [Web_UIè®¿é—®æŒ‡å—.md](Web_UIè®¿é—®æŒ‡å—.md) - Web UIä½¿ç”¨æŒ‡å—
- [æœ€ç»ˆäº¤ä»˜æŠ¥å‘Š.md](æœ€ç»ˆäº¤ä»˜æŠ¥å‘Š.md) - é¡¹ç›®äº¤ä»˜æŠ¥å‘Š
- [outputs/ç®€å†-é¡¹ç›®æè¿°.md](outputs/ç®€å†-é¡¹ç›®æè¿°.md) - ç®€å†ææ–™

## ğŸ“ é€‚ç”¨åœºæ™¯

- **ç®—æ³•é¢è¯•** - æ¨èç³»ç»Ÿ/LLMåº”ç”¨/è·¯çº¿è§„åˆ’
- **é¡¹ç›®å±•ç¤º** - å®Œæ•´çš„ç«¯åˆ°ç«¯ç³»ç»Ÿ
- **å­¦ä¹ å‚è€ƒ** - å¤šæ¡†æ¶é›†æˆå®æˆ˜
- **ç®€å†é¡¹ç›®** - å®Œæ•´çš„é¡¹ç›®ç»éªŒ

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-11-09)
- âœ… å…¨é“¾è·¯æµ‹è¯•é€šè¿‡
- âœ… LLM4Recå®Œå…¨é›†æˆï¼ˆæ„å›¾ç†è§£+é‡æ’åºï¼‰
- âœ… Web UIä¸Šçº¿
- âœ… ä»£ç æ¸…ç†å’Œæ–‡æ¡£æ›´æ–°
- âœ… GitHubåŒæ­¥

### v0.9.0 (2025-11-08)
- âœ… æ ¸å¿ƒåŠŸèƒ½å®ç°
- âœ… GPUä¼˜åŒ–
- âœ… è¯„æµ‹ç³»ç»Ÿ
- âœ… ç®€å†ææ–™ç”Ÿæˆ

## ğŸ“ è”ç³»æ–¹å¼

- **Email**: 2268867257@qq.com
- **GitHub**: [@yiweinanzi](https://github.com/yiweinanzi)
- **ä»“åº“**: https://github.com/yiweinanzi/trave_afar

## ğŸ“„ License

MIT License

---

**æœ€åæ›´æ–°**: 2025-11-09  
**é¡¹ç›®çŠ¶æ€**: âœ… **Production Ready**  
**æµ‹è¯•çŠ¶æ€**: âœ… **å…¨éƒ¨é€šè¿‡**
